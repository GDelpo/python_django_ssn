{% extends "base/base.html" %}
{% load static %}

{% block extra_css %}
<style>
  .login-card {
    animation: fadeIn 0.4s ease-in;
  }
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>
{% endblock %}

{% block full_width_content %}
<div class="flex items-start justify-center py-16 px-4 sm:px-6 lg:px-8 bg-gradient-to-b from-gray-50 to-gray-100">
  <div class="login-card w-full max-w-md" style="margin-top: 3rem;">

    <!-- Card -->
    <div class="bg-white rounded-lg shadow-lg overflow-hidden border border-gray-200">

      <!-- Header - blue gradient like home hero -->
      <div class="bg-gradient-to-r from-blue-700 to-blue-600 px-6 py-8 text-center">
        <h1 class="text-2xl font-extrabold text-white">Operaciones SSN</h1>
        <p class="mt-1 text-sm text-blue-200">Iniciá sesión para continuar</p>
      </div>

      <!-- Alerts -->
      {% if messages %}
      <div class="px-6 pt-4">
        {% for message in messages %}
        <div class="p-3 rounded-lg mb-2 flex items-start
          {% if message.tags == 'error' %}
            bg-red-50 border border-red-200 text-red-700
          {% elif message.tags == 'success' %}
            bg-green-50 border border-green-200 text-green-700
          {% elif message.tags == 'warning' %}
            bg-yellow-50 border border-yellow-200 text-yellow-700
          {% else %}
            bg-blue-50 border border-blue-200 text-blue-700
          {% endif %}
        ">
          <i class="fas {% if message.tags == 'error' %}fa-exclamation-circle text-red-500{% elif message.tags == 'success' %}fa-check-circle text-green-500{% elif message.tags == 'warning' %}fa-exclamation-triangle text-yellow-500{% else %}fa-info-circle text-blue-500{% endif %} mt-0.5 mr-2 flex-shrink-0"></i>
          <p class="text-sm font-medium">{{ message }}</p>
        </div>
        {% endfor %}
      </div>
      {% endif %}

      <!-- Form -->
      <div style="padding: 2rem 2rem 1.75rem 2rem;">
        <form method="post" novalidate style="display: flex; flex-direction: column; gap: 1.5rem;">
          {% csrf_token %}

          <!-- Email -->
          <div>
            <label for="id_email" class="block text-sm font-medium text-gray-700 mb-2">
              {{ form.email.label }}
            </label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-envelope text-gray-400"></i>
              </div>
              {{ form.email }}
            </div>
            {% if form.email.errors %}
            <p class="mt-1 text-sm text-red-600"><i class="fas fa-exclamation-circle mr-1"></i>{{ form.email.errors.0 }}</p>
            {% endif %}
          </div>

          <!-- Password -->
          <div>
            <label for="id_password" class="block text-sm font-medium text-gray-700 mb-2">
              {{ form.password.label }}
            </label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-lock text-gray-400"></i>
              </div>
              {{ form.password }}
            </div>
            {% if form.password.errors %}
            <p class="mt-1 text-sm text-red-600"><i class="fas fa-exclamation-circle mr-1"></i>{{ form.password.errors.0 }}</p>
            {% endif %}
          </div>

          <!-- Remember Me -->
          <div class="flex items-center">
            {{ form.remember_me }}
            <label for="id_remember_me" class="ml-2 text-sm text-gray-700 cursor-pointer">
              {{ form.remember_me.label }}
            </label>
          </div>

          <!-- Submit -->
          <button type="submit" class="w-full flex items-center justify-center px-8 py-3 text-base font-medium rounded-md text-white bg-blue-900 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-300 transform hover:-translate-y-0.5 hover:shadow-lg">
            <i class="fas fa-sign-in-alt mr-2"></i>
            Iniciar Sesión
          </button>
        </form>
      </div>

      <!-- Footer -->
      <div class="bg-gray-50 px-8 py-4 border-t border-gray-200 flex items-center justify-between">
        <span class="text-xs text-gray-400">
          <i class="fas fa-shield-alt mr-1 text-blue-400"></i>Conexión segura
        </span>
        {% if use_identity_service %}
        <span class="text-xs text-blue-600 font-medium">
          <i class="fas fa-cloud mr-1"></i>Servicio de Identidad
        </span>
        {% else %}
        <span class="text-xs text-gray-500 font-medium">
          <i class="fas fa-database mr-1"></i>Base de Datos Local
        </span>
        {% endif %}
      </div>
    </div>

    <!-- Support -->
    <p class="mt-5 text-center text-sm text-gray-500">
      ¿Problemas para iniciar sesión?
      <a href="mailto:{{ support_email }}" class="font-medium text-blue-600 hover:text-blue-800 transition-colors">
        {{ support_email }}
      </a>
    </p>

  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const emailField = document.getElementById('id_email');
    if (emailField && !emailField.value) emailField.focus();
  });
</script>
{% endblock %}
